## 示例：添加登录拦截器

### 项目结构：

![[java_interceptors.png]]

### `LoginInterceptor.java`

定义拦截器功能
```java
@Component
public class LoginInterceptor implements HandlerInterceptor {

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
	    // 从请求头中获取token值
        String token =request.getHeader("Authorization");
        try {
	        // 尝试解析验证token
            Map<String,Object> claims= JwtUtil.parseToken(token);
            // 放行拦截
            return true;
        }catch (Exception e){
	        // token验证失败，返回401
            response.setStatus(401);
            // 不放行
            return false;
        }
    }
}
```

>[[Jwt简单封装|JwtUtil]]

### `WebConfig`

注册拦截器
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {

    @Autowired
	private LoginInterceptor loginInterceptor; /* 声明拦截器 */
    private static final String[] EXCLUDE_PATH_PATTERNS={"/user/login","/user/register"}; /* 不拦截的路径 */

	// 添加拦截器
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(loginInterceptor).excludePathPatterns(EXCLUDE_PATH_PATTERNS);
    }
}
```

现在，访问所有路径时（除了不拦截的），都会触发拦截器验证token。

